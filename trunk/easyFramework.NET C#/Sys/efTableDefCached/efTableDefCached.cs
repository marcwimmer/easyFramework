using System;
using easyFramework.Sys.ToolLib;
using easyFramework.Sys.Data;
using easyFramework.Sys.Xml;
using easyFramework.Interfaces;
using easyFramework.Frontend.ASP.ASPTools;

namespace easyFramework.Sys.Data.Table
{
	//================================================================================
	//Class:     efTableDefCached
	//--------------------------------------------------------------------------------'
	//Module:    efTableDefCached.vb
	//--------------------------------------------------------------------------------'
	//Copyright: Promain Software-Betreuung GmbH, 2004
	//--------------------------------------------------------------------------------'
	//Purpose:   extension of the table-def; this one is cached
	//--------------------------------------------------------------------------------'
	//Created:   03.06.2004 00:10:03
	//--------------------------------------------------------------------------------'
	//Changed:
	//--------------------------------------------------------------------------------'
	
	public class efTableDefCached : ICachedItem
	{
		
		//================================================================================
		//Private Fields:
		//================================================================================
		private CachedFile moCachedFile;
		private TableDef moTableDef;
		//================================================================================
		//Public Consts:
		//================================================================================
		
		//================================================================================
		//Public Properties:
		//================================================================================
		public TableDef oTableDef
		{
			get{
				if (moCachedFile.gbFileChanged())
				{
					moTableDef = new TableDef(moCachedFile.oXmlDocument);
				}
				return moTableDef;
			}
		}
		//================================================================================
		//Public Events:
		//================================================================================
		
		//================================================================================
		//Public Methods:
		//================================================================================
		
		//================================================================================
		//Sub:       gHandleCacheDeath
		//--------------------------------------------------------------------------------'
		//Purpose:
		//--------------------------------------------------------------------------------'
		//Params:
		//--------------------------------------------------------------------------------'
		//Created:   03.06.2004 01:06:28
		//--------------------------------------------------------------------------------'
		//Changed:
		//--------------------------------------------------------------------------------'
		public void gHandleCacheDeath ()
		{
			throw (new efException("cached table-defs cannot die the cache-death! Don't set definitley " + "expiration for table-defs."));
		}
		
		
		//================================================================================
		//Sub:       gHandleExpiration
		//--------------------------------------------------------------------------------'
		//Purpose:
		//--------------------------------------------------------------------------------'
		//Params:
		//--------------------------------------------------------------------------------'
		//Created:   03.06.2004 01:06:26
		//--------------------------------------------------------------------------------'
		//Changed:
		//--------------------------------------------------------------------------------'
		public void gHandleExpiration ()
		{
			
			//doesn't need to do anything, because the cached file reloads itself
			
		}
		
		
		//================================================================================
		//Sub:       New
		//--------------------------------------------------------------------------------'
		//Purpose:   constructor
		//--------------------------------------------------------------------------------'
		//Params:
		//--------------------------------------------------------------------------------'
		//Created:   03.06.2004 00:15:31
		//--------------------------------------------------------------------------------'
		//Changed:
		//--------------------------------------------------------------------------------'
		public efTableDefCached(CachedFile oCachedFile) {
			moCachedFile = oCachedFile;
			moTableDef = new TableDef(oCachedFile.oXmlDocument);
		}
		//================================================================================
		//Protected Properties:
		//================================================================================
		
		//================================================================================
		//Protected Methods:
		//================================================================================
		
		//================================================================================
		//Private Consts:
		//================================================================================
		
		//================================================================================
		//Private Fields:
		//================================================================================
		
		//================================================================================
		//Private Methods:
		//================================================================================
		
		
	}
	
}
