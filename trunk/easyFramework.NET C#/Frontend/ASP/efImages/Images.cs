using System;
using easyFramework.Sys;
using easyFramework.Sys.Data;
using easyFramework.Sys.ToolLib;
using System.Web;
using System.Web.UI;

namespace easyFramework.Frontend.ASP.ASPTools
{
	//================================================================================
	//Class:     Images

	//--------------------------------------------------------------------------------'
	//Module:    Images.vb
	//--------------------------------------------------------------------------------'
	//Copyright: Promain Software-Betreuung GmbH
	//--------------------------------------------------------------------------------'
	//Purpose:   this class manages images; all used images are registered in the
	//           database table "tsIcons"
	//--------------------------------------------------------------------------------'
	//Created:   01.04.2004 22:09:50
	//--------------------------------------------------------------------------------'
	//Changed:
	//--------------------------------------------------------------------------------'
	
	public class Images
	{
		
		
		//================================================================================
		//Private Fields:
		//================================================================================
		
		//================================================================================
		//Public Consts:
		//================================================================================
		
		//================================================================================
		//Public Properties:
		//================================================================================
		
		//================================================================================
		//Public Events:
		//================================================================================
		
		//================================================================================
		//Public Methods:
		//================================================================================
		
		//================================================================================
		//Function:  sGetImageURL
		//--------------------------------------------------------------------------------'
		//Purpose:   returns the absolute Path to an image, like
		//           /ASP/ie/images/twenty.gif
		//--------------------------------------------------------------------------------'
		//Params:    the name of the image, like in tsIcons.icon_id
		//--------------------------------------------------------------------------------'
		//Returns:
		//--------------------------------------------------------------------------------'
		//Created:   01.04.2004 22:19:54
		//--------------------------------------------------------------------------------'
		//Changed:
		//--------------------------------------------------------------------------------'
		public static string sGetImageURL(ClientInfo oClientInfo, string sIconName, string sWebPageRoot)
		{
			
			Recordset rs = DataMethodsClientInfo.gRsGetTable(oClientInfo, "tsIcons", "icon_relativepath, " + "icon_filename", "icon_id='" + Functions.Replace(sIconName, "'", "''") + "'", "", "", "");
			
			if (rs.EOF)
			{
				throw (new efException("image \"" + sIconName + "\" not found!"));
			}
			else
			{
				
				string sResult;
				sResult = rs.oFields["icon_relativepath"].sValue;
				if (Functions.Right(sResult, 1) != "/")
				{
					sResult += "/";
				}
				
				sResult += rs.oFields["icon_filename"].sValue;
				
				if (Functions.Right(sWebPageRoot, 1) != "/")
				{
					sWebPageRoot += "/";
				}
				sResult = sWebPageRoot + sResult;
				sResult = Functions.Replace(sResult, "//", "/");
				
				return sResult;
			}
			
			
		}
		
		
		
		//================================================================================
		//Protected Properties:
		//================================================================================
		
		//================================================================================
		//Protected Methods:
		//================================================================================
		
		//================================================================================
		//Private Consts:
		//================================================================================
		
		//================================================================================
		//Private Fields:
		//================================================================================
		
		
		
	}
	
}
