using System;
using easyFramework.Sys;
using easyFramework.Sys.Data;
using easyFramework.Sys.Entities;
using easyFramework.Sys.ToolLib;
using easyFramework.Sys.Xml;
using easyFramework.Sys.SysEvents;
using easyFramework.Frontend.ASP.HTMLRenderer;
using easyFramework.Frontend.ASP.ASPTools;


namespace easyFramework.Project.SurveyManager
{
	//================================================================================
	//Class:     Publications

	//--------------------------------------------------------------------------------'
	//Module:    Publications.vb
	//--------------------------------------------------------------------------------'
	//Copyright: Promain Software-Betreuung GmbH, 2004
	//--------------------------------------------------------------------------------'
	//Purpose:
	//--------------------------------------------------------------------------------'
	//Created:   10.05.2004 19:55:16
	//--------------------------------------------------------------------------------'
	//Changed:
	//--------------------------------------------------------------------------------'

	namespace Preparation
	{
	
		public class Publications
		{
		
		
		
			//================================================================================
			//Private Fields:
			//================================================================================
		
			//================================================================================
			//Public Methods:
			//================================================================================
		
		
		
			//================================================================================
			//Sub:       gNewPublication
			//--------------------------------------------------------------------------------'
			//Purpose:   makes a new publication
			//--------------------------------------------------------------------------------'
			//Params:
			//--------------------------------------------------------------------------------'
			//Created:   10.05.2004 19:58:22
			//--------------------------------------------------------------------------------'
			//Changed:
			//--------------------------------------------------------------------------------'
			public static void gNewPublication (ClientInfo oClientInfo, int lsvy_id)
			{
			
			
				IEntity oEntity = EntityLoader.goLoadEntity(oClientInfo, svmEnums.entPublications);
			
				oEntity.gNew(oClientInfo, "");
				oEntity.oFields["pub_svy_id"].lValue = lsvy_id;
			
				oEntity.gSave(oClientInfo);
			
			
			}
		
		
		
			//================================================================================
			//Sub:       gUnPublish
			//--------------------------------------------------------------------------------'
			//Purpose:   stops the given publication
			//--------------------------------------------------------------------------------'
			//Params:
			//--------------------------------------------------------------------------------'
			//Created:   10.05.2004 19:58:24
			//--------------------------------------------------------------------------------'
			//Changed:
			//--------------------------------------------------------------------------------'
			public static void gUnPublish (ClientInfo oClientInfo, int lpub_id)
			{
			
			}
		
		
			//================================================================================
			//Function:  goCurrentActivePublication
			//--------------------------------------------------------------------------------'
			//Purpose:   returns the current, active publication
			//--------------------------------------------------------------------------------'
			//Params:
			//--------------------------------------------------------------------------------'
			//Returns:
			//--------------------------------------------------------------------------------'
			//Created:   11.05.2004 00:28:07
			//--------------------------------------------------------------------------------'
			//Changed:
			//--------------------------------------------------------------------------------'
			public static Recordset goCurrentActivePublication(string sConnstr, int lsvy_id)
			{
			
				Recordset rsResult = DataMethods.gRsGetTable(sConnstr, "tdPublications", "*", "pub_svy_id=" + lsvy_id, "", "", "pub_id desc");
			
				return rsResult;
			}
		
		}
	}

}
