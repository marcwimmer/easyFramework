using System;
using easyFramework.Sys.ToolLib;
using easyFramework.Frontend.ASP.HTMLRenderer;

namespace easyFramework.Frontend.ASP.ComplexObjects
{
	//================================================================================
	//Class:     ComboBox

	//--------------------------------------------------------------------------------'
	//Module:    ComboBox.vb
	//--------------------------------------------------------------------------------'
	//Copyright: Promain Software-Betreuung GmbH
	//--------------------------------------------------------------------------------'
	//Purpose:   select-box for html
	//--------------------------------------------------------------------------------'
	//Created:   21.05.2004 13:29:24
	//--------------------------------------------------------------------------------'
	//Changed:
	//--------------------------------------------------------------------------------'
	
	public class ComboBox
	{
		public ComboBox()
		{
			masEntries = new efArrayList();
			moHtmlSelect = new efHtmlSelect();
		}
		
		
		
		//================================================================================
		//Private Fields:
		//================================================================================
		private efArrayList masEntries;
		private string msSelectedValue;
		private string msSelectedValueCaption;
		private string msName;
		private efHtmlSelect moHtmlSelect;
		
		//================================================================================
		//Public Consts:
		//================================================================================
		
		//================================================================================
		//Public Properties:
		//================================================================================
		
		//================================================================================
//Property:  oHtmlSelect
		//--------------------------------------------------------------------------------'
//Purpose:   expose the oHtmlSelect, so the user can edit the attributes
		//--------------------------------------------------------------------------------'
//Params:
		//--------------------------------------------------------------------------------'
//Created:   24.05.2004 17:21:05
		//--------------------------------------------------------------------------------'
//Changed:
		//--------------------------------------------------------------------------------'
		public efHtmlSelect oHtmlSelect
		{
			get{
				return moHtmlSelect;
			}
		}
		//================================================================================
//Property:  sSelectedValue
		//--------------------------------------------------------------------------------'
//Purpose:   returns the selected-value; if the value doesn't
		//           exist in the entry list, it will be displayed nevertheless;
		//           in that case, you should set the sSelectedValueCaption property
		//--------------------------------------------------------------------------------'
//Params:
		//--------------------------------------------------------------------------------'
//Created:   21.05.2004 13:32:31
		//--------------------------------------------------------------------------------'
//Changed:
		//--------------------------------------------------------------------------------'
		public string sSelectedValue
		{
			get{
				return msSelectedValue;
			}
			set
			{
				msSelectedValue = value;
			}
		}
		public string sSelectedValueCaption
		{
			get{
				return msSelectedValueCaption;
			}
			set
			{
				msSelectedValueCaption = value;
			}
		}
		
		
		//================================================================================
//Property:  sName
		//--------------------------------------------------------------------------------'
//Purpose:   the name of the selectbox
		//--------------------------------------------------------------------------------'
//Params:
		//--------------------------------------------------------------------------------'
//Created:   21.05.2004 13:38:38
		//--------------------------------------------------------------------------------'
//Changed:
		//--------------------------------------------------------------------------------'
		public string sName
		{
			get{
				return msName;
			}
			set
			{
				msName = value;
			}
		}
		
		//================================================================================
		//Public Events:
		//================================================================================
		
		//================================================================================
		//Public Methods:
		//================================================================================
		
		//================================================================================
//Sub:       gAddEntry
		//--------------------------------------------------------------------------------'
//Purpose:   adds a new entry to the select-list
		//--------------------------------------------------------------------------------'
//Params:
		//--------------------------------------------------------------------------------'
//Created:   21.05.2004 13:33:19
		//--------------------------------------------------------------------------------'
//Changed:
		//--------------------------------------------------------------------------------'
		public void gAddEntry (string sValue, string sCaption)
		{
			Entry oEntry = new Entry();
			oEntry.sCaption = sCaption;
			oEntry.sValue = sValue;
			masEntries.Add(oEntry);
		}
		
		
		
		//================================================================================
//Function:  gRender
		//--------------------------------------------------------------------------------'
//Purpose:   gets the html
		//--------------------------------------------------------------------------------'
//Params:
		//--------------------------------------------------------------------------------'
//Returns:   the rendered html
		//--------------------------------------------------------------------------------'
//Created:   21.05.2004 13:36:01
		//--------------------------------------------------------------------------------'
//Changed:
		//--------------------------------------------------------------------------------'
		public string gRender()
		{
			
			
			oHtmlSelect.sSelectedValue = msSelectedValue;
			oHtmlSelect["name"].sValue = msName;
			
			bool bValueFound = false;
			for (int i = 0; i <= masEntries.Count - 1; i++)
			{
				
				Entry aEntry = ((Entry)(masEntries[i]));
				
				if (Functions.LCase(aEntry.sValue) == Functions.LCase(msSelectedValue))
				{
					bValueFound = true;
				}
				
				oHtmlSelect.gAddOption(aEntry.sValue, aEntry.sCaption);
				
			}
			
			if (! bValueFound)
			{
				
				string sSelectValueText;
				if (!Functions.IsEmptyString(msSelectedValueCaption))
				{
					sSelectValueText = msSelectedValueCaption;
				}
				else
				{
					sSelectValueText = msSelectedValue;
				}
				oHtmlSelect.gAddOption(msSelectedValue, sSelectValueText);
				
			}
			
			FastString oFast = new FastString();
			
			oHtmlSelect.gRender(oFast, 2);
			
			return oFast.ToString();
			
			
		}
		//================================================================================
		//Protected Properties:
		//================================================================================
		
		//================================================================================
		//Protected Methods:
		//================================================================================
		
		//================================================================================
		//Private Consts:
		//================================================================================
		
		//================================================================================
		//Private Fields:
		//================================================================================
		
		//================================================================================
		//Private Methods:
		//================================================================================
		
		
		//================================================================================
		//Private Classes:
		//================================================================================
		private class Entry
		{
			public string sValue;
			public string sCaption;
		}
		
	}
	
}
