using System.Diagnostics;
using System;
using System.Data;
using System.Collections;
using easyFramework.Sys.ToolLib;

namespace easyFramework.Sys.Data
{
    //================================================================================
    // Project:      easyFramework
    // Copyright:    Promain Software-Betreuung GmbH
    // Component:    DataTools.vb
    //--------------------------------------------------------------------------------
    // Purpose:      Data-Conversions
    //--------------------------------------------------------------------------------
    // Created:      21.03.04 M.Wimmer (mwimmer@promain-software.de)
    //--------------------------------------------------------------------------------
    // Changed:
    //================================================================================


    //================================================================================
    //Imports:
    //================================================================================


    public class DataTools
    {



        //================================================================================
        //public methods:
        //================================================================================






        //================================================================================
        //Function:  SQLString
        //--------------------------------------------------------------------------------'
        //Purpose:   replaces ' with '' to have sql-safe strings
        //--------------------------------------------------------------------------------'
        //Params:    the string to replace
        //--------------------------------------------------------------------------------'
        //Returns:
        //--------------------------------------------------------------------------------'
        //Created:   21.03.2004 19:14:21
        //--------------------------------------------------------------------------------'
        //Changed:
        //--------------------------------------------------------------------------------'
        public static string SQLString(string sValue)
        {
            return Functions.Replace(sValue, "'", "''");


        }

        //================================================================================
        //Function:  SQLString
        //--------------------------------------------------------------------------------'
        //Purpose:   makes a safe sql-field name by surrounding the name with brackets "["
        //--------------------------------------------------------------------------------'
        //Params:    the field-name
        //--------------------------------------------------------------------------------'
        //Returns:
        //--------------------------------------------------------------------------------'
        //Created:   21.03.2004 19:14:21
        //--------------------------------------------------------------------------------'
        //Changed:
        //--------------------------------------------------------------------------------'
        public static string SQLField(string sValue)
        {
            if (Functions.InStr2(sValue, "[") == -1)
            {
                return "[" + sValue + "]";
            }
            else
            {
                return sValue;
            }
        }
    }

    //================================================================================
    //Class:     DataToolException
    //--------------------------------------------------------------------------------'
    //Copyright: Promain Software-Betreung GmbH
    //--------------------------------------------------------------------------------'
    //Created:   21.03.2004 19:04:10
    //--------------------------------------------------------------------------------'
    //Changed:
    //--------------------------------------------------------------------------------'
    public class DataToolException : System.Exception
    {


        public DataToolException(string sMessage)
            : base(sMessage)
        {

        }


    }

}
